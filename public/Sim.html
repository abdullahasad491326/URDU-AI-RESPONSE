<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Data Search (CNIC & Mobile) - Developer Pak Updates ✅</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Syncopate:wght@700&family=Bai+Jamjuree:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <style>
    /* --- same old design --- */
    :root { --primary:#00c4ff; --secondary:#8e44ad; --background:#0a0015;
      --card-bg:rgba(2,0,5,0.8); --text-light:#f0f8ff; --text-muted:#64b5f6;
      --border-color:rgba(142,68,173,0.4); --error:#FF5722; --success:#2ECC71;}
    body[data-theme="emerald"] {--primary:#00e8c7;--secondary:#00a896;--background:#001515;--card-bg:rgba(0,5,5,0.8);--border-color:rgba(0,168,150,0.4);}
    body[data-theme="crimson"] {--primary:#ff5722;--secondary:#c0392b;--background:#150500;--card-bg:rgba(5,2,0,0.8);--border-color:rgba(192,57,43,0.4);}
    *{box-sizing:border-box;margin:0;padding:0}
    body{background-color:var(--background);font-family:'Bai Jamjuree',sans-serif;color:var(--text-light);min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px}
    .container{max-width:500px;width:100%}
    .card{background:var(--card-bg);backdrop-filter:blur(5px);border:1px solid var(--border-color);border-radius:12px;padding:30px;margin-bottom:25px;box-shadow:0 4px 15px rgba(0,0,0,0.3);transition:transform 0.2s ease}
    .card:hover{transform:translateY(-3px)}
    h2{font-family:'Syncopate',sans-serif;font-size:1.8rem;text-align:center;margin-bottom:25px;color:var(--primary)}
    h2 .icon{font-size:1.2em;margin-right:10px}
    .input-wrapper{position:relative;margin-bottom:20px}
    input[type="text"],textarea{width:100%;padding:12px 15px;font-size:16px;border-radius:8px;border:1px solid var(--border-color);outline:none;background:transparent;color:var(--text-light);font-family:'Bai Jamjuree',sans-serif;transition:border-color 0.2s ease,box-shadow 0.2s ease}
    input::placeholder,textarea::placeholder{color:var(--text-muted)}
    input:focus,textarea:focus{border-color:var(--primary);box-shadow:0 0 5px var(--primary)}
    .clear-input{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;color:var(--text-muted);font-size:16px;cursor:pointer;display:none}
    button{width:100%;padding:12px 0;font-size:16px;font-weight:600;border:none;border-radius:8px;background:var(--secondary);color:white;cursor:pointer;text-transform:uppercase;transition:background-color 0.2s ease,transform 0.2s ease}
    button:hover{background:var(--primary);transform:translateY(-2px)}
    .result,.error{padding:20px;border-radius:8px;font-size:14px;line-height:1.6;text-align:center;background:rgba(0,0,0,0.5);border:1px dashed var(--border-color)}
    .result strong{color:var(--primary)}
    .result.initial{color:var(--text-muted)}
    .error{background:rgba(255,69,0,0.2);color:var(--error);border-color:var(--error)}
    .spinner{border:3px solid rgba(255,255,255,0.2);border-top:3px solid var(--primary);border-radius:50%;width:20px;height:20px;animation:spin 1s linear infinite;display:inline-block;vertical-align:middle;margin-left:8px}
    @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
    .whatsapp-button{position:fixed;right:25px;bottom:25px;padding:12px 20px;background:var(--success);color:white;border-radius:50px;text-decoration:none;font-weight:600;box-shadow:0 4px 10px rgba(0,0,0,0.3);transition:transform 0.2s ease}
    .whatsapp-button:hover{transform:scale(1.05)}
    .theme-switcher{display:flex;gap:15px;margin-bottom:25px;padding:10px;border-radius:50px;background:rgba(0,0,0,0.4);border:1px solid rgba(255,255,255,0.1)}
    .theme-button{width:30px;height:30px;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:transform 0.2s ease,border-color 0.2s ease}
    .theme-button:hover{transform:scale(1.1)}
    .theme-button.active{border-color:var(--primary)}
    .theme-button[data-theme="default"]{background-color:#00c4ff}
    .theme-button[data-theme="emerald"]{background-color:#00e8c7}
    .theme-button[data-theme="crimson"]{background-color:#ff5722}

    /* --- New box-grid for results --- */
    .box-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:15px}
    .box-card{padding:12px;background:rgba(0,196,255,0.2);border-radius:8px;font-weight:600;text-align:center;overflow-wrap:break-word}
    .number-card{background:rgba(142,68,173,0.2)}
  </style>
</head>
<body>
  <div class="container">
    <div class="theme-switcher">
      <button class="theme-button active" data-theme="default"></button>
      <button class="theme-button" data-theme="emerald"></button>
      <button class="theme-button" data-theme="crimson"></button>
    </div>
    <section class="card">
      <h2><i class="fas fa-microchip icon"></i> Data Search (CNIC & Mobile)</h2>
      <div class="input-wrapper">
        <input type="text" id="searchInput" placeholder="Enter CNIC or mobile number" />
        <button class="clear-input"><i class="fas fa-times"></i></button>
      </div>
      <button onclick="searchData()">Search Data</button>
      <div id="simError" class="error" style="display:none;"></div>
      <div id="simResult" class="result initial">Initiating data retrieval...</div>
    </section>
  </div>
  <a href="https://whatsapp.com/channel/0029Vb9shWp4o7qPSrCXS603" target="_blank" class="whatsapp-button">
    <i class="fab fa-whatsapp icon"></i> Join Channel
  </a>
  <script>
    async function searchData() {
      const inputField = document.getElementById('searchInput');
      const simResultDiv = document.getElementById('simResult');
      const simErrorDiv = document.getElementById('simError');
      let input = inputField.value.trim().replace(/-/g, '');

      simResultDiv.classList.remove('error','initial');
      simResultDiv.innerHTML = `<p>Executing data trace... <span class="spinner"></span></p>`;
      simErrorDiv.style.display = 'none';

      const isMobile = /^03\d{9}$/.test(input);
      const isCnic = /^\d{13}$/.test(input);

      if (!isMobile && !isCnic) {
        simErrorDiv.style.display = 'block';
        simErrorDiv.innerHTML = '⚠️ Invalid format. Please enter a valid 11-digit mobile number or 13-digit CNIC.';
        simResultDiv.innerHTML = '';
        return;
      }

      try {
        const response = await fetch('/search-data', {
          method: 'POST',
          headers: { 'Content-Type':'application/json' },
          body: JSON.stringify(isMobile ? { mobileNumber: input } : { cnicNumber: input })
        });
        const data = await response.json();

        if (!response.ok) {
          simErrorDiv.style.display = 'block';
          simErrorDiv.innerHTML = data.error || '❌ Service error.';
          simResultDiv.innerHTML = '';
          return;
        }

        if (!data.name && !data.cnic && !data.address) {
          simErrorDiv.style.display = 'block';
          simErrorDiv.innerHTML = '❌ Trace incomplete.';
          simResultDiv.innerHTML = '';
          return;
        }

        // Show result in box-grid style
        let html = `<div class="box-grid">
          <div class="box-card"><strong>NAME</strong><br>${data.name}</div>
          <div class="box-card"><strong>CNIC</strong><br>${data.cnic}</div>
          <div class="box-card"><strong>ADDRESS</strong><br>${data.address}</div>
        `;

        if (data.numbers && data.numbers.length > 0) {
          data.numbers.forEach(num => {
            html += `<div class="box-card number-card"><strong>NUMBER</strong><br>${num}</div>`;
          });
        }

        html += `</div><br><span style="color: var(--success); font-weight:600;">✅ DATA ACQUIRED</span>`;
        simResultDiv.innerHTML = html;

      } catch (err) {
        simErrorDiv.style.display = 'block';
        simErrorDiv.innerHTML = '❌ Connection error.';
        simResultDiv.innerHTML = '';
      }
    }
  </script>
</body>
</html>
